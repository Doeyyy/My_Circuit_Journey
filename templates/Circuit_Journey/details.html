{% extends 'Circuit_Journey/base.html' %}

{# remove base hero (we're not touching base.html) #}
{% block hero %}{% endblock hero %}

{% block title %}{{ blogs.title }} | Circuit Journal{% endblock %}

{% block content %}
<style>
.blog-body p {
  margin-bottom: 1.5rem;
  font-size: 1.125rem; /* text-lg */
  line-height: 1.8;
  color: #374151; /* gray-700 */
}

.blog-body h1, 
.blog-body h2, 
.blog-body h3 {
  font-weight: 700;
  margin-top: 2rem;
  margin-bottom: 1rem;
  line-height: 1.25;
  color: #111827; /* gray-900 */
}

.blog-body h1 { font-size: 2.25rem; } /* text-4xl */
.blog-body h2 { font-size: 1.875rem; } /* text-3xl */
.blog-body h3 { font-size: 1.5rem; }   /* text-2xl */

.blog-body ul, 
.blog-body ol {
  margin: 1.25rem 0 1.5rem 1.5rem;
  padding-left: 1rem;
}

.blog-body li {
  margin-bottom: 0.5rem;
  list-style-type: disc;
}

.blog-body blockquote {
  border-left: 4px solid #3b82f6; /* blue-500 */
  padding-left: 1rem;
  color: #374151; /* gray-700 */
  font-style: italic;
  margin: 1.5rem 0;
}

.blog-body img {
  max-width: 100%;
  border-radius: 0.75rem; /* rounded-xl */
  margin: 2rem auto;
  display: block;
}

.blog-body a {
  color: #2563eb; /* blue-600 */
  text-decoration: underline;
}

.blog-body pre, 
.blog-body code {
  background: #f3f4f6; /* gray-100 */
  padding: 0.25rem 0.5rem;
  border-radius: 0.375rem;
  font-family: ui-monospace, monospace;
  font-size: 0.95rem;
}
</style>
<div class="max-w-5xl mx-auto px-4 py-12">

  <!-- Back button -->
  <div class="mb-6">
    <a href="{% url 'index' %}" class="inline-flex items-center text-sm font-medium"
       style="color: var(--yellowAccent);">
      ← Back
    </a>
  </div>

  <!-- Category pill + date|time (centered) -->
  <div class="text-center mb-4">
    {% if blogs.category %}
      <span class="inline-block px-4 py-1 rounded-full text-sm font-semibold"
            style="background-color: var(--yellowAccent); color: var(--dark);">
        {{ blogs.category.title }}
      </span>
    {% endif %}
    <!-- Title (54px, centered, accent color) -->
  <h1 class="mx-auto font-extrabold leading-tight mb-8" style="font-size:54px; color: var(--yellowAccent); text-align:center;">
    {{ blogs.title }}
  </h1>

    <div class="mt-3 text-sm" style="color: var(--offwhite); opacity: .8;">
      {{ blogs.created_at|date:"F j, Y" }} · {{ blogs.created_at|time:"g:i A" }}
    </div>
  </div>

  

  <!-- Featured image (wider) -->
  <!-- Media Slider -->
<div class="relative w-full max-w-4xl mx-auto mb-8">
  <div class="flex overflow-x-auto space-x-4 snap-x">
    
    {% if blogs.thumbnail %}
      <div class="flex-shrink-0 w-full snap-center">
        <p>DEBUG S3 LINK: {{ blogs.thumbnail.url }}</p>
        <img src="{{ blogs.thumbnail.url }}" alt="{{ blogs.title }}" 
             class="w-full aspect-[20/13] object-cover rounded-lg shadow-md">
      </div>
    {% endif %}

    {% if blogs.video  %}
      <div class="flex-shrink-0 w-full snap-center">
        <video controls class="w-full aspect-[20/13] object-cover rounded-lg shadow-md">
          <source src="{{ blogs.video.url  }}" type="video/mp4">
          Your browser does not support the video tag.
        </video>
      </div>
    {% endif %}
   

  </div>
</div>


  <div class="container mx-auto px-6 lg:px-20 py-10 grid grid-cols-1 lg:grid-cols-4 gap-12">
  <!-- Left Sidebar (Author Profile, sticky) -->
  <aside class="lg:col-span-1 sticky top-24 self-start">
    <div class="flex items-start space-x-4">
      {% if blogs.user.profile_pic %}
      <img src="{{ blogs.user.profile_pic.url }}" 
           class="w-16 h-16 rounded-full object-cover" alt="{{ blogs.user.username }}">
      {% else %}
      <div class="w-16 h-16 rounded-full bg-gray-300"></div>
      {% endif %}
      <div>
        <h3 class="font-semibold text-lg">{{ blogs.user.username }}</h3>
        <p class="text-sm text-gray-500">{{ blogs.user.bio }}</p>
      </div>
    </div>
  </aside>

  <!-- bodd -->
  <main class="lg:col-span-3 space-y-12">
    
    <!-- Blog Body -->
    <div class="blog-body">
    {{ blogs.body|safe }}
    </div>

    <!-- Comments Section -->
    <section id="comments" class="pt-10 border-t border-gray-200">
      <h2 class="text-2xl font-semibold mb-6">Comments</h2>

      <!-- Comment Form -->
      {% if user.is_authenticated %}
      <form method="post" class="space-y-4 mb-8">
        {% csrf_token %}
        {{ comment.as_p }}
        <button type="submit" 
                class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition">
          Post Comment
        </button>
      </form>
      {% else %}
      <p class="text-gray-500 mb-8">Login to post a comment.</p>
      {% endif %}

      <!-- Comment List -->
      <div class="space-y-6">
        {% for cm in comments %}
        <div class="border-b pb-4">
          <div class="flex items-center space-x-3 mb-2">
            {% if cm.author.profile_pic %}
            <img src="{{ cm.author.profile_pic.url }}" 
                 class="w-10 h-10 rounded-full object-cover" alt="{{ cm.author.username }}">
            {% else %}
            <div class="w-10 h-10 rounded-full bg-gray-300"></div>
            {% endif %}
            <div>
              <p class="font-medium">{{ cm.author.username }}</p>
              <p class="text-xs text-gray-400">{{ cm.created_at|date:"F j, Y" }}</p>
            </div>
          </div>
          <p class="text-gray-700">{{ cm.body }}</p>
        </div>
        {% empty %}
        <p class="text-gray-500">No comments yet. Be the first to comment!</p>
        {% endfor %}
      </div>
    </section>

    <!-- Related Posts -->
    <section class="pt-12 border-t border-gray-200">
      <h2 class="text-2xl font-semibold mb-6">Related Posts</h2>
      <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-6">
        {% for post in related_posts %}
        <a href="{% url 'Post_info' post.slug %}" 
           class="rounded-xl overflow-hidden hover:shadow-md transition block">
          {% if post.thumbnail %}
          <img src="{{ post.thumbnail.url }}" 
               alt="{{ post.title }}" 
               class="h-40 w-full object-cover">
          {% endif %}
          <div class="mt-3">
            <h3 class="font-semibold text-lg truncate">{{ post.title }}</h3>
            <p class="text-sm text-gray-500">{{ post.category.title }}</p>
          </div>
        </a>
        {% endfor %}
      </div>
    </section>
  </main>
</div>
{% endblock %}